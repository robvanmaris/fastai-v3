<!DOCTYPE html>
<html lang='nl'>
<head>
  <meta charset='utf-8'>
  <title>Fakepedia</title>
  <link rel='stylesheet' href='../static/style.css'>
  <script src="https://cdn.jsdelivr.net/npm/vue"></script>
</head>

<body>
<div id="fakepedia">
    <header>
      <h1 v-html="title"></h1></header>
    <main v-html="body"></main> 
    <hr>
    <input v-model="lemma">
    <button v-on:click="generate">Go</button>
</div>  

<script>
const app = new Vue({
  el: '#fakepedia',

  data: {
    title: 'title',
    body: 'body',
    lemma: ''
  },

  methods: {
    fetchData(lemma = 'xxbos') {
      const request = new XMLHttpRequest()
      var self = this
      request.open('GET', 'generate?start=' + lemma)
      request.onload = function() {
         result = JSON.parse(request.responseText).result
         parts = result.split(/xxbos (.*?)\n/)
         self.title = parts[1]
         lemma = parts[1].split(/ \(/)[0].trim()
         paragraphs = parts[2].replace(/\n(.*?)\n/g, '<p>$1</p>')
         paragraphs = paragraphs.replace(lemma, '<strong>' + lemma + '</strong>')
         self.body = paragraphs
      }
      request.send()
    },

    generate() {
      this.fetchData('xxbos ' + this.lemma + '%0A%0A' + this.lemma)
    }
  },

  created() {
    this.fetchData()
  }
})
</script>
</body>
</html>


